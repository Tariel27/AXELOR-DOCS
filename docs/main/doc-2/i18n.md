Интернационализация, часто называемая i18n, является очень важной особенностью любого бизнес-приложения в современной глобализированной экономике.

Открытая платформа Axelor предоставляет очень эффективный способ сделать ваше приложение многоязычным.

[](#translations)Переводы
-------------------------

В отличие от стандартной практики Java, предусматривающей предоставление каталогов переводов с файлами свойств, переводы хранятся в файлах CSV для каждой языковой базы. Это связано с тем, что открытая платформа Axelor хранит и загружает переводы из базы данных, что позволяет конечным пользователям обновлять переводы в режиме реального времени.

Структура файлов перевода в модуле axelor выглядит следующим образом:

src/main/resources/i18n/messages.csv
src/main/resources/i18n/messages\_en.csv
src/main/resources/i18n/messages\_fr.csv

Это `messages.csv`шаблон, на основе которого мы должны создавать `messages_<language>.csv`файлы для конкретного языка. Шаблон не следует обновлять вручную, поскольку он автоматически создается с помощью утилиты извлечения строк.

Следующую задачу gradle можно использовать для извлечения и обновления файлов сообщений:

    $ ./gradlew i18n [--with-context]


Файлы CSV теперь имеют четыре столбца:

*   `key`\- исходная строка

*   `message`\- переведенная строка

*   `comment`\- некоторые комментарии переводчика/переводчика языка

*   `context`\- список имен файлов с номерами строк, в которых можно найти текст


Столбец `context`заполняется только в том случае, если `--with-context`используется опция.

Сообщения перевода импортируются в базу данных во время инициализации базы данных. Соответствующая таблица базы данных хранит только `key`и `message`.

Ключом является исходный текст, извлеченный из файлов java, groovy или xml. В случае полей, где заголовок не указан, имя поля автоматически преобразуется в удобочитаемую форму.

    <entity name="Contact">
      ...
      <string name="fullName" help="true" />
      ...
    </entity>


`Full name`В этом случае, поскольку заголовок не указан, генерируется удобочитаемый текст, который используется в качестве ключа. Кроме того, `help="true"`используется для автоматического создания ключа для атрибута справки. Формат автоматического создания ключа справки таков: в этом случае генерируется `help:<entity>.<field>`ключ .`help:Contact.fullName`

Контекст представляет собой список имен файлов + номер строки, в которой находится ключ:

основной/ресурсы/домены/Contact.xml:100
основной/ресурсы/домены/Contact.xml:150
main/java/com/axelor/contact/controller/HelloController.java:57

Это означает, что ключ найден в этих файлах в данной строке. Это позволяет переводчикам находить текст и понимать контекст, чтобы обеспечить правильный перевод или предложить изменения в случае противоречивых значений. В этом случае мы можем использовать некоторые логические, нечитаемые человеком ключи и предоставить читаемый текст из перевода.

Поскольку столбец контекста начинается с многострочных значений, файлы CSV трудно редактировать в текстовых редакторах. Поэтому всегда отдавайте предпочтение редактированию с помощью некоторых редакторов электронных таблиц (Excel или libreoffice).

[](#strings)Струны
------------------

Строковые значения из источников XML не требуют какой-либо специальной обработки, но переводимые строки в вашем коде должны быть обернуты специальным методом `I18n.get(…​)`.

Он `I18n`определен в `com.axelor.i18n`пакете и предоставляет статические методы для получения переводов и собственный ResourceBundle, который можно использовать со стандартным API перевода Java.

    // get the translation for the given text
    I18n.get("Full name");
    
    // get the translation for the given key
    I18n.get("so.customer.title");
    
    // get singular or plural translation based on the given number
    I18n.get("{0} record selected.", "{0} records selected.", selected.size());


Работает только `I18n.get`тогда, когда запускается контекст JPA, поскольку перевод загружается из таблицы базы данных (которая импортируется из файлов csv во время инициализации базы данных).

Поэтому `I18n.get`не следует вызывать, если код выполняется до инициализации контекста JPA (например, статические переменные).

[](#value-translation)Перевод значений
--------------------------------------

Функция перевода значений позволяет нам переводить значения записей.

    <entity name="Product">
      <string name="name" translatable="true" /> (1)
      ...
    </entity>


**1**

поле помечено как переводимое

Переводы значений сохраняются с ключом в `value:<value>`формате. Например, `value:Laptop`или `value:Hard Disk`и т. д.

Значения полей можно перевести, щелкнув значок флажка, видимый в этом поле:

![значок перевода](../_images/translation-icon.png)

Рисунок 1. Значок перевода

Диалог перевода выглядит следующим образом:

![диалог перевода](../_images/translation-dialog.png)

Рисунок 2. Диалоговое окно перевода